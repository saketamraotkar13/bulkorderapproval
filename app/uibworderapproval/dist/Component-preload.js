//@ui5-bundle uibworderapproval/Component-preload.js
sap.ui.predefine("uibworderapproval/Component", ["sap/fe/core/AppComponent"],function(e){"use strict";return e.extend("uibworderapproval.Component",{metadata:{manifest:"json"}})});
sap.ui.predefine("uibworderapproval/ext/controller/OrderList", ["sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/Fragment"],function(e,t,a){"use strict";return{onShowKPIs:function(r,s){e.show("Loading KPI Dashboard...");var o=this.getModel();var n=this;const i=function(e){let t=[];if(!e)return t;if(e.aFilters&&e.aFilters.length>0){e.aFilters.forEach(e=>{t=t.concat(i(e))})}else if(e.sPath){t.push({path:e.sPath,operator:e.sOperator,value1:e.oValue1,value2:e.oValue2})}return t};const l=this.getFilters();let d=[];if(l.filters&&l.filters.length>0){d=i(l.filters[0])}console.log("ðŸ“Š Filters for KPI:",JSON.stringify(d));sap.ui.core.BusyIndicator.show(0);var c=o.bindContext("/getApprovalStats(...)");c.setParameter("filters",JSON.stringify(d));c.execute().then(function(){var e=c.getBoundContext().getObject();console.log("ðŸ“Š KPI Data received:",e);sap.ui.core.BusyIndicator.hide();if(!n._kpiDialog){a.load({id:"kpiFragment",name:"uibworderapproval.ext.fragments.ApprovalStats",controller:n}).then(function(t){n._kpiDialog=t;var a=new sap.ui.model.json.JSONModel({totalOrders:e.totalOrders||0,approvedOrders:e.approvedOrders||0,rejectedOrders:e.rejectedOrders||0,pendingOrders:e.pendingOrders||0,approvalRate:e.approvalRate||0,rejectionRate:e.rejectionRate||0,pendingRate:e.pendingRate||0,sumOfQuantity:e.sumOfQuantity||0,sumOfProfitAtRisk:e.sumOfProfitAtRisk||0,lastUpdated:(new Date).toLocaleString(),chartData:[{status:"Approved",count:e.approvedOrders||0},{status:"Rejected",count:e.rejectedOrders||0},{status:"Pending",count:e.pendingOrders||0}]});n._kpiDialog.setModel(a,"kpi");n._kpiDialog.open();console.log("âœ… Dialog opened with KPI data")}).catch(function(e){console.error("âŒ Error loading fragment:",e);t.error("Failed to load fragment: "+e.message)})}else{var r=n._kpiDialog.getModel("kpi");r.setData({totalOrders:e.totalOrders||0,approvedOrders:e.approvedOrders||0,rejectedOrders:e.rejectedOrders||0,pendingOrders:e.pendingOrders||0,approvalRate:e.approvalRate||0,rejectionRate:e.rejectionRate||0,pendingRate:e.pendingRate||0,sumOfQuantity:e.sumOfQuantity||0,sumOfProfitAtRisk:e.sumOfProfitAtRisk||0,lastUpdated:(new Date).toLocaleString(),chartData:[{status:"Approved",count:e.approvedOrders||0},{status:"Rejected",count:e.rejectedOrders||0},{status:"Pending",count:e.pendingOrders||0}]});n._kpiDialog.open();console.log("âœ… Dialog reopened with refreshed data")}}).catch(function(e){sap.ui.core.BusyIndicator.hide();console.error("âŒ Failed to load KPI data:",e);t.error("Failed to load KPI statistics: "+(e.message||"Unknown error"))})},onCloseTableDialog:function(){if(this._kpiDialog){this._kpiDialog.close()}},onBulkApproval:async function(e,t){if(!t||t.length===0){sap.m.MessageBox.warning("Please select at least one order.");return}const a=t[0].getModel();const r=t.map(e=>e.getObject());const s=r.map(e=>({orderNumber:e.orderNumber,itemNumber:e.itemNumber}));const o=r.length;const n=function(e){let t=[];if(!e)return t;if(e.aFilters&&e.aFilters.length>0){e.aFilters.forEach(e=>{t=t.concat(n(e))})}else if(e.sPath){t.push({path:e.sPath,operator:e.sOperator,value1:e.oValue1,value2:e.oValue2})}return t};const i=this.getFilters();let l=[];if(i.filters&&i.filters.length>0){l=n(i.filters[0])}var d=new sap.m.CheckBox({text:"Approve Load",width:"100%",selected:true});var c=new sap.m.ComboBox({width:"100%",placeholder:"Select Reason Code...",enabled:!d.getSelected(),required:!d.getSelected(),items:{path:"/reasonCodeVH",template:new sap.ui.core.ListItem({key:"{reasonCode}",text:"{reasonCode} - {description}"})}});d.attachSelect(function(e){var t=e.getParameter("selected");c.setEnabled(!t);c.setRequired(!t);if(t){c.setSelectedKey("")}});var p=new sap.m.CheckBox({text:"Apply on all filtered orders",design:"Bold",width:"90%",selected:false});var u=new sap.m.Label({text:"Selected Orders: "+o,width:"100%",visible:!p.getSelected()});p.attachSelect(function(e){u.setVisible(!e.getParameter("selected"))});var g=new sap.m.VBox({width:"100%",items:[d,new sap.m.Label({text:"Reason Code",design:"Bold"}),c,u,p],class:"sapUiSmallMargin sapUiMediumPadding"});var f=new sap.m.Dialog({title:"Bulk Approval",contentWidth:"400px",type:"Message",content:[g],beginButton:new sap.m.Button({text:"Confirm",type:"Emphasized",press:async function(){var e=d.getSelected();var t=c.getSelectedKey();var r=p.getSelected();if(!e&&!t){sap.m.MessageBox.warning("Reason Code is required when rejecting the order.");return}try{function n(e,t){const a=[];for(let r=0;r<e.length;r+=t){a.push(e.slice(r,r+t))}return a}const i=n(s,200);let u=null;sap.ui.core.BusyIndicator.show(0);for(const g of i){var o=a.bindContext("/approveOrders(...)");o.setParameter("orders",g);o.setParameter("approveLoad",e);o.setParameter("reasonCode",e?"":t);o.setParameter("filters",JSON.stringify(l));o.setParameter("allSelected",r);await o.execute();u=o.getBoundContext().getObject();console.log(u)}sap.ui.core.BusyIndicator.hide();if(u&&u.message){sap.m.MessageToast.show(u.message);a.refresh()}else{sap.m.MessageToast.show("Orders processed successfully.");a.refresh()}}catch(m){console.error("Bulk approval failed:",m);sap.m.MessageBox.error("Bulk approval failed: "+(m.message||"Unknown error"))}finally{f.close()}}}),endButton:new sap.m.Button({text:"Cancel",press:function(){f.close()}}),afterClose:function(){f.destroy()}});f.setModel(a);f.addStyleClass("sapUiContentPadding sapUiSizeCompact");f.open()}}});
sap.ui.require.preload({
	"uibworderapproval/ext/fragments/ApprovalStats.fragment.xml":'<core:FragmentDefinition\n\txmlns="sap.m"\n\txmlns:core="sap.ui.core"\n\txmlns:mvc="sap.ui.core.mvc"\n\txmlns:layout="sap.ui.layout"\n\txmlns:viz="sap.viz.ui5.controls"\n\txmlns:viz.feeds="sap.viz.ui5.controls.common.feeds"\n\txmlns:viz.data="sap.viz.ui5.data"><Dialog\n\t\tid="ShowTablePop"\n\t\ttitle="ðŸ“Š Order Approval KPIs"\n\t\tcontentWidth="100%"\n\t\tcontentHeight="100%"\n\t\tdraggable="true"\n\t\tresizable="true"\n\t\tcore:require="{handler: \'uibworderapproval/ext/controller/OrderList\'}"><content><layout:VerticalLayout class="sapUiContentPadding" width="100%"><layout:VerticalLayout width="50%" class="sapUiSmallMarginTop"><Title text="Order Status Distribution" level="H4" class="sapUiSmallMarginBottom"/><viz:VizFrame\n\t\t\t\t\t\tid="donutChart"\n\t\t\t\t\t\tuiConfig="{applicationSet:\'fiori\'}"\n\t\t\t\t\t\theight="230px"\n\t\t\t\t\t\twidth="100%"\n\t\t\t\t\t\tvizType="donut"\n\t\t\t\t\t\tvizProperties="{\n\t\t\t\t\t\t\ttitle: {\n\t\t\t\t\t\t\t\tvisible: false\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tplotArea: {\n\t\t\t\t\t\t\t\tdataLabel: {\n\t\t\t\t\t\t\t\t\tvisible: true,\n\t\t\t\t\t\t\t\t\ttype: \'value\',\n\t\t\t\t\t\t\t\t\tformatString: \'#,##0\'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tinnerRadius: 0.8\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tlegend: {\n\t\t\t\t\t\t\t\tvisible: true,\n\t\t\t\t\t\t\t\tposition: \'right\'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}"><viz:dataset><viz.data:FlattenedDataset data="{kpi>/chartData}"><viz.data:dimensions><viz.data:DimensionDefinition name="Status" value="{kpi>status}"/></viz.data:dimensions><viz.data:measures><viz.data:MeasureDefinition name="Count" value="{kpi>count}"/></viz.data:measures></viz.data:FlattenedDataset></viz:dataset><viz:feeds><viz.feeds:FeedItem uid="size" type="Measure" values="Count"/><viz.feeds:FeedItem uid="color" type="Dimension" values="Status"/></viz:feeds></viz:VizFrame></layout:VerticalLayout><Table class="sapUiSmallMarginTop" width="100%"><columns><Column width="50%"><header><Label text="Metric"/></header></Column><Column width="25%" hAlign="End"><header><Label text="Count"/></header></Column><Column width="25%" hAlign="End"><header><Label text="Percentage"/></header></Column></columns><items><ColumnListItem><cells><Text text="Total Orders"/><ObjectNumber number="{kpi>/totalOrders}" state="None"/><Text text="100.00%"/></cells></ColumnListItem><ColumnListItem><cells><Text text="Approved Orders"/><ObjectNumber number="{kpi>/approvedOrders}" state="Success"/><Text text="{kpi>/approvalRate}%"/></cells></ColumnListItem><ColumnListItem><cells><Text text="Rejected Orders"/><ObjectNumber number="{kpi>/rejectedOrders}" state="Error"/><Text text="{kpi>/rejectionRate}%"/></cells></ColumnListItem><ColumnListItem><cells><Text text="Pending Orders"/><ObjectNumber number="{kpi>/pendingOrders}" state="Warning"/><Text text="{kpi>/pendingRate}%"/></cells></ColumnListItem><ColumnListItem vAlign="Middle"><cells><ObjectIdentifier title="Other Metrics"/></cells></ColumnListItem><ColumnListItem><cells><Text text="Total Quantity"/><ObjectNumber \n\t\t\t\t\t\t\t\t\tnumber="{\n\t\t\t\t\t\t\t\t\t\tpath: \'kpi>/sumOfQuantity\',\n\t\t\t\t\t\t\t\t\t\ttype: \'sap.ui.model.type.Float\',\n\t\t\t\t\t\t\t\t\t\tformatOptions: {\n\t\t\t\t\t\t\t\t\t\t\tgroupingEnabled: true,\n\t\t\t\t\t\t\t\t\t\t\tminFractionDigits: 2,\n\t\t\t\t\t\t\t\t\t\t\tmaxFractionDigits: 2\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}" \n\t\t\t\t\t\t\t\t\tstate="None"/><Text text=""/></cells></ColumnListItem><ColumnListItem><cells><Text text="Total Profit At Risk"/><ObjectNumber \n\t\t\t\t\t\t\t\t\tnumber="{\n\t\t\t\t\t\t\t\t\t\tpath: \'kpi>/sumOfProfitAtRisk\',\n\t\t\t\t\t\t\t\t\t\ttype: \'sap.ui.model.type.Float\',\n\t\t\t\t\t\t\t\t\t\tformatOptions: {\n\t\t\t\t\t\t\t\t\t\t\tgroupingEnabled: true,\n\t\t\t\t\t\t\t\t\t\t\tminFractionDigits: 2,\n\t\t\t\t\t\t\t\t\t\t\tmaxFractionDigits: 2\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}" \n\t\t\t\t\t\t\t\t\tstate="Error"/><Text text=""/></cells></ColumnListItem></items></Table></layout:VerticalLayout></content><endButton><Button text="Close" press="handler.onCloseTableDialog"/></endButton></Dialog></core:FragmentDefinition>',
	"uibworderapproval/i18n/i18n.properties":'# This is the resource bundle for uibworderapproval\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Mass Order Approval\n\n#YDES: Application description\nappDescription=An SAP Fiori application.\n\n#XFLD,57\nsem_bworders-display.flpTitle=Mass Order Approval\n',
	"uibworderapproval/manifest.json":'{"_version":"1.76.0","sap.app":{"id":"uibworderapproval","type":"application","i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":[""]},"applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:lrop","version":"1.19.5","toolsId":"e09812ef-e52d-4397-9cc3-494f27824f43"},"dataSources":{"mainService":{"uri":"odata/v4/my-order-approval/","type":"OData","settings":{"annotations":[],"odataVersion":"4.0"}}},"crossNavigation":{"inbounds":{"sem_bworders-display":{"semanticObject":"sem_bworders","action":"display","title":"{{sem_bworders-display.flpTitle}}","signature":{"parameters":{},"additionalParameters":"allowed"}}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":true,"dependencies":{"minUI5Version":"1.142.0","libs":{"sap.m":{},"sap.ui.core":{},"sap.fe.templates":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"uibworderapproval.i18n.i18n","supportedLocales":[""]}},"":{"dataSource":"mainService","preload":true,"settings":{"operationMode":"Server","autoExpandSelect":true,"earlyRequests":true}},"@i18n":{"type":"sap.ui.model.resource.ResourceModel","uri":"i18n/i18n.properties","settings":{"supportedLocales":[""]}}},"resources":{"css":[]},"routing":{"config":{},"routes":[{"pattern":":?query:","name":"OrdersList","target":"OrdersList"},{"pattern":"Orders({key}):?query:","name":"OrdersObjectPage","target":"OrdersObjectPage"}],"targets":{"OrdersList":{"type":"Component","id":"OrdersList","name":"sap.fe.templates.ListReport","options":{"settings":{"contextPath":"/Orders","variantManagement":"Page","navigation":{"Orders":{"detail":{"route":"OrdersObjectPage"}}},"controlConfiguration":{"@com.sap.vocabularies.UI.v1.LineItem":{"tableSettings":{"type":"GridTable"},"actions":{"bulkapproval":{"press":"uibworderapproval.ext.controller.OrderList.onBulkApproval","visible":true,"enabled":true,"requiresSelection":true,"text":"Mass Approval"},"ShowKPI":{"press":"uibworderapproval.ext.controller.OrderList.onShowKPIs","visible":true,"enabled":true,"requiresSelection":false,"text":"Show KPIs","position":{"placement":"Before","anchor":"bulkapproval"}}}}},"initialLoad":"Enabled"}}},"OrdersObjectPage":{"type":"Component","id":"OrdersObjectPage","name":"sap.fe.templates.ObjectPage","options":{"settings":{"contextPath":"/Orders","editMode":"Editable"}}}}},"flexBundle":false},"sap.fiori":{"registrationIds":[],"archeType":"transactional"},"sap.cloud":{"public":true,"service":"bworderapproval.service"}}'
});
//# sourceMappingURL=Component-preload.js.map
