sap.ui.define(["sap/m/MessageToast","sap/m/MessageBox"],function(e,t){"use strict";return{onBulkApproval:async function(e,t){if(!t||t.length===0){sap.m.MessageBox.warning("Please select at least one order.");return}const a=t[0].getModel();const s=t.map(e=>e.getObject());const r=s.map(e=>({orderNumber:e.orderNumber,itemNumber:e.itemNumber}));const o=s.length;const n=function(e){let t=[];if(!e)return t;if(e.aFilters&&e.aFilters.length>0){e.aFilters.forEach(e=>{t=t.concat(n(e))})}else if(e.sPath){t.push({path:e.sPath,operator:e.sOperator,value1:e.oValue1,value2:e.oValue2})}return t};const l=this.getFilters();let i=[];if(l.filters&&l.filters.length>0){i=n(l.filters[0])}var c=new sap.m.CheckBox({text:"Approve Load",width:"100%",selected:true});var d=new sap.m.ComboBox({width:"100%",placeholder:"Select Reason Code...",enabled:!c.getSelected(),required:!c.getSelected(),items:{path:"/reasonCodeVH",template:new sap.ui.core.ListItem({key:"{reasonCode}",text:"{reasonCode} - {description}"})}});c.attachSelect(function(e){var t=e.getParameter("selected");d.setEnabled(!t);d.setRequired(!t)});var p=new sap.m.CheckBox({text:"Apply on all filtered orders",design:"Bold",width:"90%",selected:false});var u=new sap.m.Label({text:"Selected Orders: "+o,width:"100%",visible:!p.getSelected()});p.attachSelect(function(e){u.setVisible(!e.getParameter("selected"))});var f=new sap.m.VBox({width:"100%",items:[c,new sap.m.Label({text:"Reason Code",design:"Bold"}),d,u,p],class:"sapUiSmallMargin sapUiMediumPadding"});var m=new sap.m.Dialog({title:"Bulk Approval",contentWidth:"400px",type:"Message",content:[f],beginButton:new sap.m.Button({text:"Confirm",type:"Emphasized",press:async function(){var e=c.getSelected();var t=d.getSelectedKey();var s=p.getSelected();if(!e&&!t){sap.m.MessageBox.warning("Reason Code is required when rejecting the order.");return}try{function n(e,t){const a=[];for(let s=0;s<e.length;s+=t){a.push(e.slice(s,s+t))}return a}const l=n(r,200);for(const u of l){var o=a.bindContext("/approveOrders(...)");o.setParameter("orders",u);o.setParameter("approveLoad",e);o.setParameter("reasonCode",t);o.setParameter("filters",JSON.stringify(i));o.setParameter("allSelected",s);await o.execute()}sap.m.MessageToast.show("Orders processed successfully.");a.refresh()}catch(f){console.error("Bulk approval failed:",f);sap.m.MessageBox.error("Bulk approval failed: "+(f.message||"Unknown error"))}finally{m.close()}}}),endButton:new sap.m.Button({text:"Cancel",press:function(){m.close()}}),afterClose:function(){m.destroy()}});m.setModel(a);m.addStyleClass("sapUiContentPadding sapUiSizeCompact");m.open()},_flattenFilters:function(e){let t=[];if(!e)return t;if(e.aFilters&&e.aFilters.length>0){e.aFilters.forEach(e=>{t=t.concat(this._flattenFilters(e))})}else if(e.sPath){t.push({path:e.sPath,operator:e.sOperator,value1:e.oValue1,value2:e.oValue2})}return t}}});
//# sourceMappingURL=OrderList.js.map