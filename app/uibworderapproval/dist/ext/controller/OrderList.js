sap.ui.define(["sap/m/MessageToast","sap/m/MessageBox"],function(e,t){"use strict";return{onBulkApproval:async function(e,t){debugger;if(!t||t.length===0){sap.m.MessageBox.warning("Please select at least one order.");return}const s=t[0].getModel();const a=t.map(e=>e.getObject().orderNumber);const r=sap.ui.getCore().byId("OrdersList");const o=r&&r.getContent?r.getContent()[0].getTable():null;let n=o?o.getBinding("items")||o.getBinding("rows"):null;const l=function(e){let t=[];if(!e)return t;if(e.aFilters&&e.aFilters.length>0){e.aFilters.forEach(e=>{t=t.concat(l(e))})}else if(e.sPath){t.push({path:e.sPath,operator:e.sOperator,value1:e.oValue1,value2:e.oValue2})}return t};const i=this.getFilters();let p=[];if(i.filters&&i.filters.length>0){p=l(i.filters[0])}console.log("Flattened Filters:",p);var c=new sap.m.ComboBox({width:"100%",placeholder:"Select Reason Code...",enabled:true,items:{path:"/reasonCodeVH",template:new sap.ui.core.ListItem({key:"{reasonCode}",text:"{reasonCode} - {description}"})}});var d=new sap.m.CheckBox({text:"Approve Load",width:"90%",selected:true});var u=new sap.m.VBox({width:"90%",items:[d,new sap.m.Label({text:"Reason Code",design:"Bold"}),c],class:"sapUiSmallMargin sapUiMediumPadding"});var g=new sap.m.Dialog({title:"Bulk Approval",contentWidth:"400px",type:"Message",content:[u],beginButton:new sap.m.Button({text:"Confirm",type:"Emphasized",press:async function(){var e=d.getSelected();var t=c.getSelectedKey();if(!e&&!t){sap.m.MessageBox.warning("Reason Code is required when rejecting the order.");return}try{function o(e,t){const s=[];for(let a=0;a<e.length;a+=t){s.push(e.slice(a,a+t))}return s}const n=o(a,200);for(const l of n){var r=s.bindContext("/approveOrders(...)");r.setParameter("orders",l);r.setParameter("approveLoad",e);r.setParameter("reasonCode",t);r.setParameter("filters",JSON.stringify(p));await r.execute()}sap.m.MessageToast.show("Orders processed successfully.");s.refresh()}catch(i){console.error("Bulk approval failed:",i);sap.m.MessageBox.error("Bulk approval failed: "+(i.message||"Unknown error"))}finally{g.close()}}}),endButton:new sap.m.Button({text:"Cancel",press:function(){g.close()}}),afterClose:function(){g.destroy()}});g.setModel(s);g.addStyleClass("sapUiContentPadding sapUiSizeCompact");g.open()},_flattenFilters:function(e){let t=[];if(!e)return t;if(e.aFilters&&e.aFilters.length>0){e.aFilters.forEach(e=>{t=t.concat(this._flattenFilters(e))})}else if(e.sPath){t.push({path:e.sPath,operator:e.sOperator,value1:e.oValue1,value2:e.oValue2})}return t}}});
//# sourceMappingURL=OrderList.js.map